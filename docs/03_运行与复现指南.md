# 运行与复现指南

本指南描述完整的复现流程与产出文件。

---

## 1. 目录结构

```
ProblemC-1/
├── data/                  # 原始数据与补充数据
├── src/
│   ├── dwts_model/        # 核心模型代码
│   └── scripts/           # 执行脚本
├── paper/
│   ├── main.tex           # 英文论文
│   ├── main_zh.tex        # 中文论文
│   └── figures/           # 共享图表（唯一图表源）
├── outputs/               # 分析结果与表格
└── docs/                  # 技术文档
```

---

## 2. 一键流程

建议使用主流程脚本：

```bash
python src/scripts/run_full_pipeline.py --samples 2000 --smooth-sigma 0.15
```

可选参数：
- `--smooth-sigma 0.10`：增强时间平滑
- `--skip-ml`：跳过 XGBoost+SHAP（依赖未安装时）
- `--skip-compile`：仅生成图表，不编译 PDF

---

## 3. 关键输出

### 数据文件（`outputs/`）
- `fan_vote_intervals.csv`
- `fan_vote_posterior_summary.csv`
- `counterfactual_matrix.csv`
- `save_sensitivity.csv`
- `democratic_deficit.csv`
- `pareto_frontier.csv`
- `ppc_summary.csv`
- `forward_chaining_metrics.csv`

### 图表文件（`paper/figures/`）
- `fig_q1_hdi_band.pdf`
- `fig_q1_uncertainty_heatmap.pdf`
- `fig_q1_ppc_metrics.pdf`
- `fig_q1_risk_bar.pdf`
- `fig_q2_counterfactual_matrix.pdf`
- `fig_q2_save_sensitivity.pdf`
- `fig_q2_democratic_deficit.pdf`
- `fig_q3_forward_chaining.pdf`
- `fig_shap_summary.pdf`
- `fig_shap_interaction.pdf`
- `fig_q4_pareto_frontier.pdf`
- `figures/fig_q4_alpha_schedule.pdf`
- `figures/fig_q4_noise_robustness.pdf`
- `paper/en/PaperC/main.pdf`
- `paper/zh/PaperC - Chinese/main.pdf`

---

## 4. 环境依赖
- Python 3.10+
- numpy, pandas, scipy, matplotlib, seaborn
- xgboost, shap（用于特征分析）
- LaTeX: xelatex + biber（推荐 latexmk）

---

## 5. 常见问题
- **平滑不足**：增大样本数或降低 \(\sigma\)（更强平滑）。
- **SHAP 图生成失败**：确认 xgboost 与 shap 版本可用。
- **PDF 编译失败**：检查 LaTeX 工具链是否安装并可用。
