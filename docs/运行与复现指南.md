# 运行与复现指南（新版框架）

本指南描述模型一的完整复现流程与产出文件。

---

## 1. 目录结构
- `data/`：原始数据与补充数据
- `src/`：核心模型代码
- `scripts/`：主流程脚本
- `figures/`：生成的论文图表
- `outputs/`：分析结果与表格
- `paper/`：中英文论文

---

## 2. 一键流程
建议使用主流程脚本：

```bash
python scripts/run_full_pipeline.py --samples 2000 --smooth-sigma 0.15
```

可选参数：
- `--smooth-sigma 0.10`：增强时间平滑
- `--skip-ml`：跳过 XGBoost+SHAP（依赖未安装时）
- `--skip-compile`：仅生成图表，不编译 PDF

---

## 3. 关键输出
- `outputs/fan_vote_intervals.csv`
- `outputs/fan_vote_posterior_summary.csv`
- `outputs/counterfactual_matrix.csv`
- `outputs/save_sensitivity.csv`
- `outputs/democratic_deficit.csv`
- `outputs/pareto_frontier.csv`
- `outputs/ppc_summary.csv`
- `outputs/forward_chaining_metrics.csv`
- `figures/fig_q1_hdi_band.pdf`
- `figures/fig_q1_uncertainty_heatmap.pdf`
- `figures/fig_q1_ppc_metrics.pdf`
- `figures/fig_q1_risk_bar.pdf`
- `figures/fig_q2_counterfactual_matrix.pdf`
- `figures/fig_q2_save_sensitivity.pdf`
- `figures/fig_q2_democratic_deficit.pdf`
- `figures/fig_q3_forward_chaining.pdf`
- `figures/fig_shap_summary.pdf`
- `figures/fig_shap_interaction.pdf`
- `figures/fig_q4_pareto_frontier.pdf`
- `figures/fig_q4_alpha_schedule.pdf`
- `figures/fig_q4_noise_robustness.pdf`
- `paper/en/PaperC/main.pdf`
- `paper/zh/PaperC - Chinese/main.pdf`

---

## 4. 环境依赖
- Python 3.10+
- numpy, pandas, scipy, matplotlib, seaborn
- xgboost, shap（用于特征分析）
- LaTeX: xelatex + biber（推荐 latexmk）

---

## 5. 常见问题
- **平滑不足**：增大样本数或降低 \(\sigma\)（更强平滑）。
- **SHAP 图生成失败**：确认 xgboost 与 shap 版本可用。
- **PDF 编译失败**：检查 LaTeX 工具链是否安装并可用。
